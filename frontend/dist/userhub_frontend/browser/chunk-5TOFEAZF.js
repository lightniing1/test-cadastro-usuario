import{a as A,b,c as G,d as $,e as B,f as H,g as W,h as z,i as J}from"./chunk-327DDUEG.js";import{C as T,G as C,I as x,K as g,L as i,M as r,N as S,O as q,P as _,Q as f,R as o,S as P,T as N,W as p,X as w,_ as F,e as O,fa as V,h as U,j as D,k as h,m as j,p as a,q as I,s as R,t as L,v as y,y as c,z as l}from"./chunk-RZ62GIQF.js";function M(n,e){let t=!e?.manualCleanup;t&&!e?.injector&&I(M);let u=t?e?.injector?.get(y)??a(y):null,m=Q(e?.equal),d;e?.requireSync?d=c({kind:0},{equal:m}):d=c({kind:1,value:e?.initialValue},{equal:m});let k,E=n.subscribe({next:s=>d.set({kind:1,value:s}),error:s=>{if(e?.rejectErrors)throw s;d.set({kind:2,error:s})},complete:()=>{k?.()}});if(e?.requireSync&&d().kind===0)throw new h(601,!1);return k=u?.onDestroy(E.unsubscribe.bind(E)),p(()=>{let s=d();switch(s.kind){case 1:return s.value;case 2:throw s.error;case 0:throw new h(601,!1)}},{equal:e?.equal})}function Q(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var v=class n{http=a(F);API_URL="http://localhost:8080/users";getProfile(){return this.http.get(`${this.API_URL}/me`)}updateProfile(e){return this.http.put(`${this.API_URL}/me`,e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};function Y(n,e){n&1&&(i(0,"p"),o(1,"Loading profile..."),r())}function Z(n,e){n&1&&(i(0,"div",1),o(1," Could not load profile. Please try again later. "),r())}function ee(n,e){if(n&1&&(i(0,"div",5),o(1),r()),n&2){let t=f(2);l(),P(t.successMessage())}}function te(n,e){if(n&1&&(i(0,"div",1),o(1),r()),n&2){let t=f(2);l(),P(t.errorMessage())}}function ne(n,e){if(n&1){let t=q();i(0,"form",4),_("ngSubmit",function(){R(t);let m=f();return L(m.onUpdate())}),C(1,ee,2,1,"div",5)(2,te,2,1,"div",1),i(3,"div",6)(4,"label",7),o(5,"Name"),r(),S(6,"input",8),r(),i(7,"div",6)(8,"label",9),o(9,"Email"),r(),S(10,"input",10),r(),i(11,"button",11),o(12),r()()}if(n&2){let t=f();x("formGroup",t.form),l(),g(t.successMessage()?1:-1),l(),g(t.errorMessage()?2:-1),l(9),x("disabled",t.form.invalid||t.isLoading()),l(),N(" ",t.isLoading()?"Updating...":"Update Profile"," ")}}var K=class n{fb=a(z);userService=a(v);authService=a(V);isLoading=c(!1);errorMessage=c(null);successMessage=c(null);userProfile$=this.userService.getProfile().pipe(D(null),U(e=>O({error:e.message})));userProfile=M(this.userProfile$);isProfileLoading=p(()=>this.userProfile()===null);hasProfileError=p(()=>this.userProfile()&&"error"in this.userProfile());form=this.fb.group({name:["",[b.required]],email:["",[b.required,b.email]]});constructor(){w(()=>{let e=this.userProfile();e&&!("error"in e)&&this.form.patchValue(e)})}onUpdate(){if(this.form.invalid)return;this.isLoading.set(!0),this.errorMessage.set(null),this.successMessage.set(null);let e=this.form.getRawValue();this.userService.updateProfile(e).subscribe({next:t=>{this.isLoading.set(!1),this.successMessage.set("Profile updated successfully!"),this.form.patchValue(t)},error:t=>{this.isLoading.set(!1),this.errorMessage.set(t.error?.message||"Update failed.")}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=T({type:n,selectors:[["app-settings"]],decls:8,vars:1,consts:[[1,"container"],[1,"error-message"],[3,"formGroup"],[1,"logout-button",3,"click"],[3,"ngSubmit","formGroup"],[1,"success-message"],[1,"form-field"],["for","name"],["id","name","type","text","formControlName","name"],["for","email"],["id","email","type","email","formControlName","email"],["type","submit",3,"disabled"]],template:function(t,u){t&1&&(i(0,"div",0)(1,"h1"),o(2,"Settings"),r(),C(3,Y,2,0,"p")(4,Z,2,0,"div",1)(5,ne,13,5,"form",2),i(6,"button",3),_("click",function(){return u.authService.signOut()}),o(7," Sign Out "),r()()),t&2&&(l(3),g(u.isProfileLoading()?3:u.hasProfileError()?4:5))},dependencies:[J,B,A,G,$,H,W],styles:[".container[_ngcontent-%COMP%]{max-width:500px;margin:auto;padding:2rem}.form-field[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem}input[_ngcontent-%COMP%]{width:100%;padding:.5rem}button[_ngcontent-%COMP%]{width:100%;padding:.75rem;cursor:pointer}.logout-button[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;margin-top:2rem}.error-message[_ngcontent-%COMP%]{color:red;margin-bottom:1rem}.success-message[_ngcontent-%COMP%]{color:green;margin-bottom:1rem}"],changeDetection:0})};export{K as SettingsComponent};
